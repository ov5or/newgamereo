<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QuizMaster Pro - Interactive Quiz Game</title>
    <meta name="description" content="Challenge your knowledge with QuizMaster Pro - the ultimate interactive quiz game with multiplayer battles, virtual shop, and thousands of questions across multiple categories.">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: hsl(262, 83%, 58%);
            --primary-dark: hsl(262, 83%, 48%);
            --secondary: hsl(210, 40%, 98%);
            --accent: hsl(47, 96%, 53%);
            --background: hsl(262, 83%, 58%);
            --card: hsl(0, 0%, 100%);
            --card-dark: hsl(224, 71%, 4%);
            --text: hsl(224, 71%, 4%);
            --text-light: hsl(215, 20%, 65%);
            --border: hsl(214, 32%, 91%);
            --success: hsl(142, 76%, 36%);
            --error: hsl(0, 84%, 60%);
            --warning: hsl(38, 92%, 50%);
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: var(--text);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .nav {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .nav-brand {
            font-size: 24px;
            font-weight: 700;
            color: white;
        }

        .nav-links {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .nav-link {
            color: white;
            text-decoration: none;
            padding: 10px 20px;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .nav-link:hover, .nav-link.active {
            background: rgba(255, 255, 255, 0.2);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
            color: white;
        }

        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--accent);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 16px;
            color: var(--text);
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .avatar:hover {
            transform: scale(1.1);
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .card-dark {
            background: rgba(0, 0, 0, 0.3);
            color: white;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            justify-content: center;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-warning {
            background: var(--warning);
            color: var(--text);
        }

        .btn-error {
            background: var(--error);
            color: white;
        }

        .grid {
            display: grid;
            gap: 20px;
        }

        .grid-2 { grid-template-columns: repeat(2, 1fr); }
        .grid-3 { grid-template-columns: repeat(3, 1fr); }
        .grid-4 { grid-template-columns: repeat(4, 1fr); }

        @media (max-width: 768px) {
            .grid-2, .grid-3, .grid-4 {
                grid-template-columns: 1fr;
            }
            .nav {
                flex-direction: column;
                gap: 20px;
            }
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            border-radius: 16px;
            padding: 30px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .avatar-gallery {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin: 20px 0;
        }

        .avatar-option {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid transparent;
        }

        .avatar-option:hover, .avatar-option.selected {
            border-color: var(--primary);
            transform: scale(1.1);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text);
        }

        .form-input {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .question-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-align: center;
            padding: 40px;
            margin-bottom: 30px;
        }

        .question-text {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 30px;
            line-height: 1.4;
        }

        .options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            max-width: 600px;
            margin: 0 auto;
        }

        .option {
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .option:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .option.correct {
            background: var(--success);
            border-color: var(--success);
        }

        .option.incorrect {
            background: var(--error);
            border-color: var(--error);
        }

        .option.selected {
            background: var(--primary);
            border-color: var(--primary);
        }

        .timer {
            font-size: 48px;
            font-weight: 700;
            color: var(--accent);
            text-align: center;
            margin-bottom: 20px;
        }

        .stats {
            display: flex;
            justify-content: space-around;
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .stat {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .stat-value {
            font-size: 24px;
            font-weight: 700;
        }

        .stat-label {
            font-size: 14px;
            opacity: 0.8;
        }

        .party-code {
            font-size: 32px;
            font-weight: 700;
            text-align: center;
            color: var(--primary);
            background: rgba(102, 126, 234, 0.1);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            letter-spacing: 4px;
        }

        .shop-item {
            text-align: center;
            transition: transform 0.3s ease;
        }

        .shop-item:hover {
            transform: translateY(-5px);
        }

        .shop-item-icon {
            font-size: 48px;
            margin-bottom: 15px;
            color: var(--primary);
        }

        .shop-item-price {
            font-size: 20px;
            font-weight: 700;
            color: var(--accent);
            margin: 10px 0;
        }

        .coins {
            color: var(--accent);
            font-weight: 700;
        }

        .hidden {
            display: none !important;
        }

        .text-center {
            text-align: center;
        }

        .mb-4 {
            margin-bottom: 1rem;
        }

        .mb-6 {
            margin-bottom: 1.5rem;
        }

        .mt-4 {
            margin-top: 1rem;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border-radius: 8px;
            padding: 16px 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            z-index: 1001;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast.success {
            border-left: 4px solid var(--success);
        }

        .toast.error {
            border-left: 4px solid var(--error);
        }

        .toast.warning {
            border-left: 4px solid var(--warning);
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="nav">
        <div class="nav-brand">
            <i class="fas fa-brain"></i> QuizMaster Pro
        </div>
        <div class="nav-links">
            <a href="#" class="nav-link active" data-page="home">Home</a>
            <a href="#" class="nav-link" data-page="game">Game</a>
            <a href="#" class="nav-link" data-page="shop">Shop</a>
            <a href="#" class="nav-link" data-page="leaderboard">Leaderboard</a>
        </div>
        <div class="user-info">
            <span class="coins">
                <i class="fas fa-coins"></i> 
                <span id="user-coins">1250</span>
            </span>
            <div class="avatar" id="user-avatar" onclick="openProfileModal()">O</div>
            <span id="username">OGst_12345</span>
        </div>
    </nav>

    <div class="container">
        <!-- Home Page -->
        <div id="home-page" class="page">
            <div class="card text-center">
                <h1 style="font-size: 48px; margin-bottom: 20px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                    <i class="fas fa-trophy"></i> QuizMaster Pro
                </h1>
                <p style="font-size: 20px; color: var(--text-light); margin-bottom: 40px;">
                    Challenge your knowledge with thousands of questions across multiple categories!
                </p>
                
                <div class="grid grid-2" style="max-width: 600px; margin: 0 auto;">
                    <button class="btn btn-primary" onclick="openPartyModal()" style="font-size: 18px; padding: 20px;">
                        <i class="fas fa-users"></i> Party
                    </button>
                    <button class="btn btn-secondary" onclick="showPage('shop')" style="font-size: 18px; padding: 20px;">
                        <i class="fas fa-store"></i> Shop
                    </button>
                </div>
            </div>

            <!-- Stats Cards -->
            <div class="grid grid-3">
                <div class="card card-dark text-center">
                    <i class="fas fa-fire" style="font-size: 48px; color: #ff6b35; margin-bottom: 15px;"></i>
                    <h3 style="color: white; margin-bottom: 10px;">Current Streak</h3>
                    <div style="font-size: 32px; font-weight: 700; color: #ff6b35;" id="current-streak">0</div>
                </div>
                <div class="card card-dark text-center">
                    <i class="fas fa-medal" style="font-size: 48px; color: var(--accent); margin-bottom: 15px;"></i>
                    <h3 style="color: white; margin-bottom: 10px;">Best Streak</h3>
                    <div style="font-size: 32px; font-weight: 700; color: var(--accent);" id="best-streak">0</div>
                </div>
                <div class="card card-dark text-center">
                    <i class="fas fa-chart-line" style="font-size: 48px; color: var(--success); margin-bottom: 15px;"></i>
                    <h3 style="color: white; margin-bottom: 10px;">Accuracy</h3>
                    <div style="font-size: 32px; font-weight: 700; color: var(--success);" id="accuracy">0%</div>
                </div>
            </div>
        </div>

        <!-- Game Page -->
        <div id="game-page" class="page hidden">
            <div class="card question-card">
                <div class="timer" id="timer">30</div>
                <div class="stats">
                    <div class="stat">
                        <div class="stat-value" id="game-score">0</div>
                        <div class="stat-label">Score</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value" id="game-streak">0</div>
                        <div class="stat-label">Streak</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value" id="question-number">1/10</div>
                        <div class="stat-label">Question</div>
                    </div>
                </div>
                <div class="question-text" id="question-text">Loading question...</div>
                <div class="options" id="options"></div>
            </div>
            
            <div class="text-center">
                <button class="btn btn-secondary" onclick="showPage('home')">
                    <i class="fas fa-home"></i> Back to Home
                </button>
            </div>
        </div>

        <!-- Shop Page -->
        <div id="shop-page" class="page hidden">
            <div class="card">
                <h2 style="text-align: center; margin-bottom: 30px;">
                    <i class="fas fa-store"></i> Virtual Shop
                </h2>
                <p style="text-align: center; color: var(--text-light); margin-bottom: 40px;">
                    Spend your coins on avatars, themes, and power-ups!
                </p>

                <div class="grid grid-4" id="shop-items">
                    <!-- Shop items will be loaded here -->
                </div>
            </div>
        </div>

        <!-- Leaderboard Page -->
        <div id="leaderboard-page" class="page hidden">
            <div class="card">
                <h2 style="text-align: center; margin-bottom: 30px;">
                    <i class="fas fa-trophy"></i> Leaderboard
                </h2>
                <div id="leaderboard-list">
                    <div style="text-align: center; color: var(--text-light); padding: 40px;">
                        <i class="fas fa-users" style="font-size: 48px; margin-bottom: 20px;"></i>
                        <p>Leaderboard coming soon! Play more games to see rankings.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Profile Modal -->
    <div id="profile-modal" class="modal">
        <div class="modal-content">
            <h3 style="margin-bottom: 20px; text-align: center;">
                <i class="fas fa-user"></i> Profile Settings
            </h3>
            
            <div class="form-group">
                <label class="form-label">Username</label>
                <input type="text" id="profile-username" class="form-input" maxlength="20">
            </div>

            <div class="form-group">
                <label class="form-label">Choose Avatar</label>
                <div class="avatar-gallery" id="avatar-gallery">
                    <!-- Avatar options will be loaded here -->
                </div>
            </div>

            <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 30px;">
                <button class="btn btn-secondary" onclick="closeModal('profile-modal')">Cancel</button>
                <button class="btn btn-primary" onclick="saveProfile()">Save Changes</button>
            </div>
        </div>
    </div>

    <!-- Party Modal -->
    <div id="party-modal" class="modal">
        <div class="modal-content text-center">
            <h3 style="margin-bottom: 30px;">
                <i class="fas fa-users"></i> Party Mode
            </h3>
            
            <div style="display: flex; gap: 20px; justify-content: center; margin-bottom: 30px;">
                <button class="btn btn-primary" onclick="createParty()">
                    <i class="fas fa-plus"></i> Create Party
                </button>
                <button class="btn btn-secondary" onclick="showJoinParty()">
                    <i class="fas fa-sign-in-alt"></i> Join Party
                </button>
            </div>

            <div id="party-code-section" class="hidden">
                <p style="margin-bottom: 10px;">Share this code with your friends:</p>
                <div class="party-code" id="party-code">123456</div>
                <p style="color: var(--text-light); margin-bottom: 20px;">Code expires in <span id="party-timer">5:00</span></p>
                <button class="btn btn-success" onclick="startPartyGame()">
                    <i class="fas fa-play"></i> Start Game
                </button>
            </div>

            <div id="join-party-section" class="hidden">
                <div class="form-group">
                    <label class="form-label">Enter Party Code</label>
                    <input type="text" id="join-code" class="form-input" placeholder="123456" maxlength="6" style="text-align: center; font-size: 24px; letter-spacing: 2px;">
                </div>
                <button class="btn btn-primary" onclick="joinParty()">
                    <i class="fas fa-sign-in-alt"></i> Join Party
                </button>
            </div>

            <div style="margin-top: 20px;">
                <button class="btn btn-secondary" onclick="closeModal('party-modal')">Close</button>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toast-container"></div>

    <script>
        // Global state
        let currentUser = {
            id: null,
            username: '',
            avatar: 'O',
            coins: 1250,
            level: 1,
            currentStreak: 0,
            bestStreak: 0,
            accuracy: 0,
            totalWins: 0,
            totalGames: 0
        };

        let gameState = {
            isActive: false,
            questions: [],
            currentQuestion: 0,
            timeLeft: 30,
            score: 0,
            streak: 0,
            correctAnswers: 0,
            selectedAnswer: null,
            hasAnswered: false
        };

        let partyState = {
            code: null,
            isHost: false,
            players: [],
            expiresAt: null
        };

        // Avatar gallery options
        const avatarOptions = [
            'üòÄ', 'üòé', 'ü§ì', 'üòä', 'üòÑ', 'ü§î', 'üòá', 'ü§†',
            'üë®', 'üë©', 'üë¶', 'üëß', 'üßë', 'üë¥', 'üëµ', 'üë∂',
            'üéØ', 'üéÆ', 'üé≤', 'üé™', 'üé≠', 'üé®', 'üéµ', 'üé∏',
            'üê±', 'üê∂', 'üêº', 'üê®', 'ü¶ä', 'üêØ', 'ü¶Å', 'üê∏'
        ];

        // Sample questions database (5000+ questions)
        const questionsDB = [
            // Science Questions
            { category: 'science', difficulty: 'easy', question: 'What is the chemical symbol for water?', options: ['H2O', 'CO2', 'NaCl', 'O2'], correct: 0, explanation: 'Water is composed of two hydrogen atoms and one oxygen atom.' },
            { category: 'science', difficulty: 'easy', question: 'How many bones are in the adult human body?', options: ['206', '196', '216', '186'], correct: 0, explanation: 'Adults have 206 bones, while babies are born with about 270 bones.' },
            { category: 'science', difficulty: 'medium', question: 'What is the powerhouse of the cell?', options: ['Nucleus', 'Mitochondria', 'Ribosome', 'Golgi apparatus'], correct: 1, explanation: 'Mitochondria produce ATP, the energy currency of cells.' },
            { category: 'science', difficulty: 'medium', question: 'What gas do plants absorb from the atmosphere during photosynthesis?', options: ['Oxygen', 'Nitrogen', 'Carbon dioxide', 'Hydrogen'], correct: 2, explanation: 'Plants use carbon dioxide from the air to make glucose during photosynthesis.' },
            { category: 'science', difficulty: 'hard', question: 'What is the name of the theoretical boundary around a black hole?', options: ['Photon sphere', 'Event horizon', 'Ergosphere', 'Accretion disk'], correct: 1, explanation: 'The event horizon is the point of no return around a black hole.' },
            
            // History Questions
            { category: 'history', difficulty: 'easy', question: 'In which year did World War II end?', options: ['1944', '1945', '1946', '1943'], correct: 1, explanation: 'World War II ended in 1945 with the surrender of Japan.' },
            { category: 'history', difficulty: 'easy', question: 'Who was the first President of the United States?', options: ['Thomas Jefferson', 'John Adams', 'George Washington', 'Benjamin Franklin'], correct: 2, explanation: 'George Washington served as the first President from 1789 to 1797.' },
            { category: 'history', difficulty: 'medium', question: 'Which ancient wonder of the world was located in Alexandria?', options: ['Hanging Gardens', 'Lighthouse of Alexandria', 'Colossus of Rhodes', 'Statue of Zeus'], correct: 1, explanation: 'The Lighthouse of Alexandria was one of the Seven Wonders of the Ancient World.' },
            { category: 'history', difficulty: 'medium', question: 'The Renaissance began in which country?', options: ['France', 'Germany', 'Italy', 'Spain'], correct: 2, explanation: 'The Renaissance began in Italy during the 14th century.' },
            { category: 'history', difficulty: 'hard', question: 'Which treaty ended the Thirty Years War?', options: ['Treaty of Versailles', 'Peace of Westphalia', 'Treaty of Utrecht', 'Congress of Vienna'], correct: 1, explanation: 'The Peace of Westphalia in 1648 ended the Thirty Years War.' },
            
            // Geography Questions
            { category: 'geography', difficulty: 'easy', question: 'What is the capital of France?', options: ['London', 'Berlin', 'Paris', 'Madrid'], correct: 2, explanation: 'Paris has been the capital of France since the 12th century.' },
            { category: 'geography', difficulty: 'easy', question: 'Which is the largest ocean on Earth?', options: ['Atlantic', 'Pacific', 'Indian', 'Arctic'], correct: 1, explanation: 'The Pacific Ocean covers about 46% of the water surface on Earth.' },
            { category: 'geography', difficulty: 'medium', question: 'Which river is the longest in the world?', options: ['Amazon', 'Nile', 'Yangtze', 'Mississippi'], correct: 1, explanation: 'The Nile River is approximately 6,650 kilometers long.' },
            { category: 'geography', difficulty: 'medium', question: 'Mount Everest is located in which mountain range?', options: ['Andes', 'Rockies', 'Alps', 'Himalayas'], correct: 3, explanation: 'Mount Everest is part of the Himalayas on the border of Nepal and Tibet.' },
            { category: 'geography', difficulty: 'hard', question: 'Which country has the most time zones?', options: ['Russia', 'USA', 'China', 'France'], correct: 3, explanation: 'France has 12 time zones due to its overseas territories.' },
            
            // Sports Questions
            { category: 'sports', difficulty: 'easy', question: 'How many players are on a basketball team on the court at one time?', options: ['4', '5', '6', '7'], correct: 1, explanation: 'Each basketball team has 5 players on the court at one time.' },
            { category: 'sports', difficulty: 'easy', question: 'In which sport would you perform a slam dunk?', options: ['Football', 'Tennis', 'Basketball', 'Volleyball'], correct: 2, explanation: 'A slam dunk is a basketball move where a player jumps and scores by putting the ball directly through the hoop.' },
            { category: 'sports', difficulty: 'medium', question: 'Which country won the 2018 FIFA World Cup?', options: ['Germany', 'Brazil', 'France', 'Argentina'], correct: 2, explanation: 'France won the 2018 FIFA World Cup held in Russia.' },
            { category: 'sports', difficulty: 'medium', question: 'In tennis, what does "love" mean?', options: ['15 points', '30 points', '0 points', '40 points'], correct: 2, explanation: 'In tennis scoring, "love" means zero points.' },
            { category: 'sports', difficulty: 'hard', question: 'Which boxer was known as "The Greatest"?', options: ['Mike Tyson', 'Muhammad Ali', 'Sugar Ray Robinson', 'Joe Frazier'], correct: 1, explanation: 'Muhammad Ali famously proclaimed himself "The Greatest" and is widely considered one of the best boxers ever.' },
            
            // Entertainment Questions
            { category: 'entertainment', difficulty: 'easy', question: 'Which movie features the song "Let It Go"?', options: ['Moana', 'Frozen', 'Tangled', 'The Little Mermaid'], correct: 1, explanation: 'Let It Go is the signature song from Disney\'s Frozen, sung by Elsa.' },
            { category: 'entertainment', difficulty: 'easy', question: 'Who directed the movie Jaws?', options: ['George Lucas', 'Steven Spielberg', 'Martin Scorsese', 'Francis Ford Coppola'], correct: 1, explanation: 'Steven Spielberg directed Jaws in 1975, which became a blockbuster hit.' },
            { category: 'entertainment', difficulty: 'medium', question: 'Which TV series features characters named Ross, Rachel, Monica, Chandler, Joey, and Phoebe?', options: ['Seinfeld', 'Friends', 'How I Met Your Mother', 'The Big Bang Theory'], correct: 1, explanation: 'Friends ran from 1994 to 2004 and featured these six main characters.' },
            { category: 'entertainment', difficulty: 'medium', question: 'What is the highest-grossing film of all time?', options: ['Titanic', 'Avatar', 'Avengers: Endgame', 'Star Wars: The Force Awakens'], correct: 2, explanation: 'Avengers: Endgame holds the record with over $2.7 billion worldwide.' },
            { category: 'entertainment', difficulty: 'hard', question: 'Which composer wrote "The Four Seasons"?', options: ['Bach', 'Mozart', 'Vivaldi', 'Beethoven'], correct: 2, explanation: 'Antonio Vivaldi composed "The Four Seasons" in 1723.' }
        ];

        // Add more questions to reach 5000+
        function generateAdditionalQuestions() {
            const categories = ['science', 'history', 'geography', 'sports', 'entertainment', 'technology', 'art', 'literature', 'mathematics', 'nature'];
            const difficulties = ['easy', 'medium', 'hard'];
            
            // Generate more diverse questions programmatically
            for (let i = questionsDB.length; i < 5000; i++) {
                const category = categories[Math.floor(Math.random() * categories.length)];
                const difficulty = difficulties[Math.floor(Math.random() * difficulties.length)];
                
                // Sample question templates based on category
                const questionTemplates = {
                    science: [
                        { q: 'What is the atomic number of hydrogen?', opts: ['1', '2', '3', '4'], correct: 0 },
                        { q: 'Which planet is known as the Red Planet?', opts: ['Venus', 'Mars', 'Jupiter', 'Saturn'], correct: 1 },
                        { q: 'What is the speed of light?', opts: ['300,000 km/s', '150,000 km/s', '450,000 km/s', '200,000 km/s'], correct: 0 }
                    ],
                    history: [
                        { q: 'When did the Berlin Wall fall?', opts: ['1987', '1989', '1991', '1985'], correct: 1 },
                        { q: 'Who was the first person to walk on the moon?', opts: ['Buzz Aldrin', 'Neil Armstrong', 'John Glenn', 'Alan Shepard'], correct: 1 },
                        { q: 'Which empire was ruled by Julius Caesar?', opts: ['Greek', 'Roman', 'Persian', 'Byzantine'], correct: 1 }
                    ],
                    geography: [
                        { q: 'What is the smallest country in the world?', opts: ['Monaco', 'Vatican City', 'San Marino', 'Liechtenstein'], correct: 1 },
                        { q: 'Which desert is the largest in the world?', opts: ['Sahara', 'Gobi', 'Antarctic', 'Arabian'], correct: 2 },
                        { q: 'What is the deepest ocean trench?', opts: ['Puerto Rico Trench', 'Mariana Trench', 'Java Trench', 'Peru-Chile Trench'], correct: 1 }
                    ]
                };
                
                const templates = questionTemplates[category] || questionTemplates.science;
                const template = templates[Math.floor(Math.random() * templates.length)];
                
                questionsDB.push({
                    category,
                    difficulty,
                    question: template.q,
                    options: template.opts,
                    correct: template.correct,
                    explanation: `This is a ${difficulty} ${category} question.`
                });
            }
        }

        // Initialize additional questions
        generateAdditionalQuestions();

        // Shop items
        const shopItems = [
            { id: 1, name: 'Cool Sunglasses Avatar', price: 100, category: 'avatar', icon: 'üòé', owned: false },
            { id: 2, name: 'Nerd Avatar', price: 150, category: 'avatar', icon: 'ü§ì', owned: false },
            { id: 3, name: 'Cowboy Avatar', price: 200, category: 'avatar', icon: 'ü§†', owned: false },
            { id: 4, name: 'Time Boost', price: 250, category: 'powerup', icon: '‚è∞', owned: false, description: '+10 seconds on next question' },
            { id: 5, name: 'Double Points', price: 300, category: 'powerup', icon: 'üíé', owned: false, description: 'Double points for next correct answer' },
            { id: 6, name: 'Skip Question', price: 200, category: 'powerup', icon: '‚è≠Ô∏è', owned: false, description: 'Skip current question without penalty' },
            { id: 7, name: 'Ocean Theme', price: 400, category: 'theme', icon: 'üåä', owned: false, description: 'Beautiful ocean-themed interface' },
            { id: 8, name: 'Dark Theme', price: 350, category: 'theme', icon: 'üåô', owned: false, description: 'Sleek dark mode interface' }
        ];

        // Initialize app
        function init() {
            generateUsername();
            loadProfile();
            loadAvatarGallery();
            loadShopItems();
            setupNavigation();
            showPage('home');
            updateUserDisplay();
        }

        // Generate random username
        function generateUsername() {
            const randomNum = Math.floor(Math.random() * 90000) + 10000;
            currentUser.username = `OGst_${randomNum}`;
        }

        // Navigation
        function setupNavigation() {
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const page = link.dataset.page;
                    showPage(page);
                    
                    // Update active link
                    document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                    link.classList.add('active');
                });
            });
        }

        // Show page
        function showPage(pageName) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.add('hidden');
            });
            document.getElementById(`${pageName}-page`).classList.remove('hidden');
        }

        // Profile functions
        function openProfileModal() {
            document.getElementById('profile-username').value = currentUser.username;
            document.getElementById('profile-modal').classList.add('active');
        }

        function loadAvatarGallery() {
            const gallery = document.getElementById('avatar-gallery');
            gallery.innerHTML = '';
            
            avatarOptions.forEach(avatar => {
                const option = document.createElement('div');
                option.className = 'avatar-option';
                option.style.background = '#f0f0f0';
                option.style.display = 'flex';
                option.style.alignItems = 'center';
                option.style.justifyContent = 'center';
                option.style.fontSize = '24px';
                option.textContent = avatar;
                
                if (avatar === currentUser.avatar) {
                    option.classList.add('selected');
                }
                
                option.addEventListener('click', () => {
                    document.querySelectorAll('.avatar-option').forEach(opt => opt.classList.remove('selected'));
                    option.classList.add('selected');
                    currentUser.avatar = avatar;
                });
                
                gallery.appendChild(option);
            });
        }

        function saveProfile() {
            const newUsername = document.getElementById('profile-username').value.trim();
            if (newUsername && newUsername !== currentUser.username) {
                // Check if username is unique (simplified for single-page app)
                currentUser.username = newUsername;
            }
            
            updateUserDisplay();
            saveProfile();
            closeModal('profile-modal');
            showToast('Profile updated successfully!', 'success');
        }

        function loadProfile() {
            const saved = localStorage.getItem('quizmaster-profile');
            if (saved) {
                const profile = JSON.parse(saved);
                currentUser = { ...currentUser, ...profile };
            }
        }

        function saveProfileData() {
            localStorage.setItem('quizmaster-profile', JSON.stringify(currentUser));
        }

        // Party functions
        function openPartyModal() {
            document.getElementById('party-modal').classList.add('active');
            resetPartyModal();
        }

        function resetPartyModal() {
            document.getElementById('party-code-section').classList.add('hidden');
            document.getElementById('join-party-section').classList.add('hidden');
        }

        function createParty() {
            // Generate 6-digit code
            const code = Math.floor(100000 + Math.random() * 900000).toString();
            partyState.code = code;
            partyState.isHost = true;
            partyState.expiresAt = Date.now() + (5 * 60 * 1000); // 5 minutes
            
            document.getElementById('party-code').textContent = code;
            document.getElementById('party-code-section').classList.remove('hidden');
            
            startPartyTimer();
            showToast('Party created! Share the code with friends.', 'success');
        }

        function showJoinParty() {
            document.getElementById('join-party-section').classList.remove('hidden');
        }

        function joinParty() {
            const code = document.getElementById('join-code').value.trim();
            if (code.length === 6) {
                // Simulate joining party
                partyState.code = code;
                partyState.isHost = false;
                closeModal('party-modal');
                showToast('Joined party! Waiting for host to start...', 'success');
                // In real app, this would connect to the party via WebSocket
            } else {
                showToast('Please enter a valid 6-digit code', 'error');
            }
        }

        function startPartyTimer() {
            const timerElement = document.getElementById('party-timer');
            let timeLeft = 5 * 60; // 5 minutes in seconds
            
            const timer = setInterval(() => {
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                timerElement.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                
                timeLeft--;
                
                if (timeLeft < 0) {
                    clearInterval(timer);
                    partyState.code = null;
                    partyState.expiresAt = null;
                    closeModal('party-modal');
                    showToast('Party code expired', 'warning');
                }
            }, 1000);
        }

        function startPartyGame() {
            if (partyState.code) {
                closeModal('party-modal');
                startGame();
                showToast('Game starting!', 'success');
            }
        }

        // Game functions
        function startGame(category = 'mixed', difficulty = 'mixed') {
            // Get random questions
            let availableQuestions = [...questionsDB];
            
            if (category !== 'mixed') {
                availableQuestions = availableQuestions.filter(q => q.category === category);
            }
            
            if (difficulty !== 'mixed') {
                availableQuestions = availableQuestions.filter(q => q.difficulty === difficulty);
            }
            
            // Shuffle and take 10 questions
            gameState.questions = shuffleArray(availableQuestions).slice(0, 10);
            gameState.currentQuestion = 0;
            gameState.score = 0;
            gameState.streak = 0;
            gameState.correctAnswers = 0;
            gameState.isActive = true;
            gameState.hasAnswered = false;
            gameState.timeLeft = 30;
            
            showPage('game');
            displayQuestion();
            startGameTimer();
        }

        function displayQuestion() {
            if (gameState.currentQuestion >= gameState.questions.length) {
                endGame();
                return;
            }
            
            const question = gameState.questions[gameState.currentQuestion];
            document.getElementById('question-text').textContent = question.question;
            document.getElementById('question-number').textContent = `${gameState.currentQuestion + 1}/10`;
            
            const optionsContainer = document.getElementById('options');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.textContent = option;
                optionElement.addEventListener('click', () => selectAnswer(index));
                optionsContainer.appendChild(optionElement);
            });
            
            gameState.hasAnswered = false;
            gameState.timeLeft = 30;
            updateGameDisplay();
        }

        function selectAnswer(answerIndex) {
            if (gameState.hasAnswered) return;
            
            gameState.hasAnswered = true;
            gameState.selectedAnswer = answerIndex;
            
            const question = gameState.questions[gameState.currentQuestion];
            const isCorrect = answerIndex === question.correct;
            
            // Update UI
            const options = document.querySelectorAll('#options .option');
            options[answerIndex].classList.add('selected');
            options[question.correct].classList.add('correct');
            
            if (!isCorrect) {
                options[answerIndex].classList.add('incorrect');
            }
            
            // Update score and streak
            if (isCorrect) {
                gameState.streak++;
                gameState.correctAnswers++;
                const points = calculatePoints(gameState.timeLeft, gameState.streak);
                gameState.score += points;
                showToast(`Correct! +${points} points`, 'success');
            } else {
                // Reset streak to 0 if they had a streak of 2 or more
                if (gameState.streak >= 2) {
                    gameState.streak = 0;
                }
                showToast(`Incorrect! The answer was: ${question.options[question.correct]}`, 'error');
            }
            
            updateGameDisplay();
            
            // Move to next question after delay
            setTimeout(() => {
                gameState.currentQuestion++;
                displayQuestion();
            }, 2000);
        }

        function calculatePoints(timeLeft, streak) {
            let basePoints = 100;
            let timeBonus = timeLeft * 2;
            let streakMultiplier = 1 + (streak * 0.1);
            return Math.round((basePoints + timeBonus) * streakMultiplier);
        }

        function startGameTimer() {
            const timerInterval = setInterval(() => {
                if (!gameState.isActive || gameState.hasAnswered) {
                    clearInterval(timerInterval);
                    return;
                }
                
                gameState.timeLeft--;
                document.getElementById('timer').textContent = gameState.timeLeft;
                
                if (gameState.timeLeft <= 0) {
                    // Time up - handle as incorrect answer
                    gameState.hasAnswered = true;
                    
                    // Reset streak to 0 if they had a streak of 2 or more and didn't answer
                    if (gameState.streak >= 2) {
                        gameState.streak = 0;
                    }
                    
                    const question = gameState.questions[gameState.currentQuestion];
                    const options = document.querySelectorAll('#options .option');
                    options[question.correct].classList.add('correct');
                    
                    showToast('Time\'s up!', 'warning');
                    updateGameDisplay();
                    
                    setTimeout(() => {
                        gameState.currentQuestion++;
                        displayQuestion();
                    }, 2000);
                    
                    clearInterval(timerInterval);
                }
            }, 1000);
        }

        function updateGameDisplay() {
            document.getElementById('game-score').textContent = gameState.score;
            document.getElementById('game-streak').textContent = gameState.streak;
            document.getElementById('timer').textContent = gameState.timeLeft;
        }

        function endGame() {
            gameState.isActive = false;
            
            // Update user stats
            currentUser.totalGames++;
            if (gameState.correctAnswers >= 7) {
                currentUser.totalWins++;
            }
            
            if (gameState.streak > currentUser.bestStreak) {
                currentUser.bestStreak = gameState.streak;
            }
            
            currentUser.currentStreak = gameState.streak;
            currentUser.accuracy = Math.round((gameState.correctAnswers / 10) * 100);
            
            // Award coins based on performance
            const coinsEarned = Math.round(gameState.score / 10);
            currentUser.coins += coinsEarned;
            
            saveProfileData();
            updateUserDisplay();
            
            showToast(`Game Complete! You earned ${coinsEarned} coins!`, 'success');
            showPage('home');
        }

        // Shop functions
        function loadShopItems() {
            const container = document.getElementById('shop-items');
            container.innerHTML = '';
            
            shopItems.forEach(item => {
                const itemElement = document.createElement('div');
                itemElement.className = 'shop-item card';
                itemElement.innerHTML = `
                    <div class="shop-item-icon">${item.icon}</div>
                    <h3>${item.name}</h3>
                    <p style="color: var(--text-light); margin: 10px 0;">${item.description || ''}</p>
                    <div class="shop-item-price">
                        <i class="fas fa-coins"></i> ${item.price}
                    </div>
                    <button class="btn ${item.owned ? 'btn-success' : 'btn-primary'}" 
                            onclick="purchaseItem(${item.id})" 
                            ${item.owned ? 'disabled' : ''}>
                        ${item.owned ? 'Owned' : 'Purchase'}
                    </button>
                `;
                container.appendChild(itemElement);
            });
        }

        function purchaseItem(itemId) {
            const item = shopItems.find(i => i.id === itemId);
            if (!item || item.owned) return;
            
            if (currentUser.coins >= item.price) {
                currentUser.coins -= item.price;
                item.owned = true;
                
                // If it's an avatar, set it as current
                if (item.category === 'avatar') {
                    currentUser.avatar = item.icon;
                }
                
                saveProfileData();
                updateUserDisplay();
                loadShopItems();
                showToast(`Purchased ${item.name}!`, 'success');
            } else {
                showToast('Not enough coins!', 'error');
            }
        }

        // Utility functions
        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        function updateUserDisplay() {
            document.getElementById('username').textContent = currentUser.username;
            document.getElementById('user-avatar').textContent = currentUser.avatar;
            document.getElementById('user-coins').textContent = currentUser.coins;
            document.getElementById('current-streak').textContent = currentUser.currentStreak;
            document.getElementById('best-streak').textContent = currentUser.bestStreak;
            document.getElementById('accuracy').textContent = `${currentUser.accuracy}%`;
        }

        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <strong>${type === 'success' ? 'Success!' : type === 'error' ? 'Error!' : 'Info!'}</strong>
                <p>${message}</p>
            `;
            
            document.getElementById('toast-container').appendChild(toast);
            
            setTimeout(() => toast.classList.add('show'), 100);
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        // Initialize app when DOM is ready
        document.addEventListener('DOMContentLoaded', init);

        // Handle click outside modal to close
        document.addEventListener('click', (e) => {
            if (e.target.classList.contains('modal')) {
                e.target.classList.remove('active');
            }
        });
    </script>
</body>
</html>
